<?php
//Create some dataset for the table user
$user = array(array("test", "test123"),
            array("key", "key123")
);

//Ask user to enter their username and password
$username = readline("Username: ");
$password = readline("Password: ");

//detect the sql injection attack by using function
function detect_tautologies($username){
    if (preg_match('/\bOR\s*1=1\b/', $username)){
        return true;
    }
    return false;
}

//if got sql injection
if(detect_tautologies($username)){
    echo "SQL Injection Attack. Malicious Input.\n";
    echo "SQL QUERY: SELECT * FROM users WHERE username = '$username'AND password = '$password';\n ";
}
//not sql injection
else{
    echo "SQL QUERY: SELECT * FROM users WHERE username = '$username'AND password = '$password';\n ";

    $login = false;
    foreach($user as $test){
        if ($test[0] === $username && $test[1] === $password){
            $login = true;
            echo "Login successfully. Welcome, '$test[0]'";
            break;
        }
    }
    if(!$login){
        echo "Invalid username or password.";
    }
}

?>



